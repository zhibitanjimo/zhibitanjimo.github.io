<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Simple 2048 Game</title>
<style>
  .grid {
    display: grid;
    grid-template-columns: repeat(3, 100px);
    gap: 5px;
  }
  .cell {
    width: 100px;
    height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #eee;
    border: 1px solid #999;
    font-size: 2em;
  }
</style>
</head>
<body>
<div class="grid" id="grid">
  <!-- Cells will be generated by JavaScript -->
</div>

<script>
const grid = document.getElementById('grid');
const size = 3;
let gridArray = [];

// Initialize the game
function initGame() {
  for (let i = 0; i < size * size; i++) {
    const cell = document.createElement('div');
    cell.className = 'cell';
    gridArray.push(0);
    grid.appendChild(cell);
  }
  spawnRandomNumber();
  spawnRandomNumber();
}

// Spawn a random number (2 or 4)
function spawnRandomNumber() {
  const emptyCells = gridArray.filter(cell => cell === 0).map((cell, index) => index);
  if (emptyCells.length > 0) {
    const emptyCellIndex = emptyCells[Math.floor(Math.random() * emptyCells.length)];
    gridArray[emptyCellIndex] = Math.random() < 0.5 ? 2 : 4;
    updateGrid();
  }
}

// Move the tiles in the grid
function moveTiles(direction) {
  const moves = {
    'up': (row, col) => {
      for (let c = 0; c < size; c++) {
        let current = size * row + c;
        let next = current;
        while (next >= 1 && gridArray[next - 1] === 0) {
          gridArray[next] = gridArray[next - 1];
          gridArray[next - 1] = 0;
          next--;
        }
        if (next > 0 && gridArray[next - 1] === gridArray[next]) {
          gridArray[next] *= 2;
          gridArray[next - 1] = 0;
        }
      }
    },
    'down': (row, col) => {
      for (let c = size - 1; c >= 0; c--) {
        let current = size * row + c;
        let next = current;
        while (next < size * (size - 1) && gridArray[next + 1] === 0) {
          gridArray[next] = gridArray[next + 1];
          gridArray[next + 1] = 0;
          next++;
        }
        if (next < size * (size - 1) && gridArray[next + 1] === gridArray[next]) {
          gridArray[next] *= 2;
          gridArray[next + 1] = 0;
        }
      }
    },
    'left': (row, col) => {
      for (let r = 0; r < size; r++) {
        let current = size * r + col;
        let next = current;
        while (next >= size && gridArray[next - size] === 0) {
          gridArray[next] = gridArray[next - size];
          gridArray[next - size] = 0;
          next -= size;
        }
        if (next >= size && gridArray[next - size] === gridArray[next]) {
          gridArray[next] *= 2;
          gridArray[next - size] = 0;
        }
      }
    },
    'right': (row, col) => {
      for (let r = size - 1; r >= 0; r--) {
        let current = size * r + col;
        let next = current;
        while (next < size * size - size && gridArray[next + size] === 0) {
          gridArray[next] = gridArray[next + size];
          gridArray[next + size] = 0;
          next += size;
        }
        if (next < size * size - size && gridArray[next + size] === gridArray[next]) {
          gridArray[next] *= 2;
          gridArray[next + size] = 0;
        }
      }
    }
  };

  const row = Math.floor(direction.indexOf('up') !== -1 || direction.indexOf('down') !== -1 ? direction.indexOf('up') !== -1 : 1);
  const col = direction.indexOf('up') !== -1 || direction.indexOf('down') !== -1 ? 1 : Math.floor(direction.indexOf('left') !== -1 || direction.indexOf('right') !== -1 ? direction.indexOf('left') !== -1 : 1);

  moves[direction](row, col);
  updateGrid();
  spawnRandomNumber();
}

// Update the grid visually
function updateGrid() {
  gridArray.forEach((value, index) => {
    const cell = grid.children[index];
    cell.innerHTML = value === 0 ? '' : value;
  });
}

// Key press event listener
document.addEventListener('keydown', (e) => {
  const direction = {
    'ArrowUp': 'up',
    'ArrowDown': 'down',
    'ArrowLeft': 'left',
    'ArrowRight': 'right'
  }[e.code];
  if (direction) {
    moveTiles(direction);
  }
});

initGame();
</script>
</body>
</html>